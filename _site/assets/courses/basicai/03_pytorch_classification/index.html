<!DOCTYPE html>
<html lang="en">
  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <!-- Metadata, OpenGraph and Schema.org -->




<!-- Standard metadata -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>
  
  
    
      PyTorch Neural Network Classification | Jue Guo
    
  
</title>
<meta name="author" content="Jue Guo">
<meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.
">

  <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website">










<!-- Bootstrap & MDB -->
<link rel="stylesheet" href="/personal/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

<!-- Bootstrap Table -->


<!-- Fonts & Icons -->
<link defer rel="stylesheet" href="/personal/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5">
<link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap">

<!-- Code Syntax Highlighting -->
<link defer rel="stylesheet" href="/personal/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light">


  <!-- Sidebar Table of Contents -->
  <link defer href="/personal/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet">


<!-- Styles -->

<!-- pseudocode -->



  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A4%96&lt;/text&gt;&lt;/svg&gt;">

<link rel="stylesheet" href="/personal/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e">
<link rel="canonical" href="http://0.0.0.0:8080/personal/assets/courses/basicai/03_pytorch_classification/">

<!-- Dark Mode -->
<script src="/personal/assets/js/theme.js?5ce9accf63efc46cd59e47ccb47fd172"></script>


<!-- GeoJSON support via Leaflet -->


<!-- diff2html -->





  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">
    <!-- Header -->
    <header>
  <!-- Nav Bar -->
  <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation">
    <div class="container">
      
        <a class="navbar-brand title font-weight-lighter" href="/personal//">
          
            
              <span class="font-weight-bold">Jue</span>
            
            
            Guo
          
        </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>

      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          

          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/personal/">about
              
            </a>
          </li>

          <!-- Other pages -->
          
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
              
                
                <li class="nav-item ">
                  
                  <a class="nav-link" href="/personal/teaching/">courses
                    
                  </a>
                </li>
              
            
          
            
          
            
              
                
                <li class="nav-item ">
                  
                  <a class="nav-link" href="/personal/cv/">cv
                    
                  </a>
                </li>
              
            
          
            
          
            
          
            
          
          
          
        </ul>
      </div>
    </div>
  </nav>
  
    <!-- Scrolling Progress Bar -->
    <progress id="progress" value="0">
      <div class="progress-container">
        <span class="progress-bar"></span>
      </div>
    </progress>
  
</header>

    <!-- Content -->
    <div class="container mt-5" role="main">
      
        
          <div class="row">
            <!-- sidebar, which will move to the top on a small screen -->
            <div class="col-sm-3">
              <nav id="toc-sidebar" class="sticky-top"></nav>
            </div>
            <!-- main content area -->
            <div class="col-sm-9">


  <div class="fixed-bottom-button">
    <a href="/personal/teaching/aibasic" class="btn-back-course">
      ← AI Basics
    </a>
  </div>


<!-- Always apply separation lines (scoped to article) -->

  <style type="text/css">
    /* Heading 1 */
    .post > article h1 {
      border-bottom: 4px solid #4CAF50; /* Green separation line */
      padding-bottom: 12px;
      margin-top: 40px; /* Increased spacing above */
      margin-bottom: 32px; /* Increased spacing below */
    }

    /* Heading 2 */
    .post > article h2 {
      border-bottom: 3px solid #2196F3; /* Blue separation line */
      padding-bottom: 10px;
      margin-top: 36px; /* Increased spacing above */
      margin-bottom: 28px; /* Increased spacing below */
    }

    /* Heading 3 */
    .post > article h3 {
      border-bottom: 3px dashed #FFC107; /* Yellow dashed line */
      padding-bottom: 8px;
      margin-top: 32px; /* Increased spacing above */
      margin-bottom: 24px; /* Increased spacing below */
    }

    /* Heading 4 */
    .post > article h4 {
      border-bottom: 2px dotted #9C27B0; /* Purple dotted line */
      padding-bottom: 6px;
      margin-top: 28px; /* Increased spacing above */
      margin-bottom: 20px; /* Increased spacing below */
    }

    /* Heading 5 */
    .post > article h5 {
      border-bottom: 2px solid #FF5722; /* Orange solid line */
      padding-bottom: 4px;
      margin-top: 24px; /* Increased spacing above */
      margin-bottom: 16px; /* Increased spacing below */
    }
  </style>



  <!-- Numbered Headings CSS -->
  <style type="text/css">
    /* Base reset for counters */
    body {
      counter-reset: h1-counter 2;
    }

    /* Heading 1 */
    .post > article h1 {
      counter-increment: h1-counter;
      counter-reset: h2-counter;
      
      /* Show h1 number */
      
    }

    
    .post > article h1::before {
      content: counter(h1-counter) ". ";
    }
    

    /* Heading 2 */
    .post > article h2 {
      counter-increment: h2-counter;
      counter-reset: h3-counter;
    }

    .post > article h2::before {
      content: counter(h1-counter) "." counter(h2-counter) " ";
    }

    /* Heading 3 */
    .post > article h3 {
      counter-increment: h3-counter;
      counter-reset: h4-counter;
    }

    .post > article h3::before {
      content: counter(h1-counter) "." counter(h2-counter) "." counter(h3-counter) " ";
    }

    /* Heading 4 */
    .post > article h4 {
      counter-increment: h4-counter;
      counter-reset: h5-counter;
    }

    .post > article h4::before {
      content: counter(h1-counter) "." counter(h2-counter) "." counter(h3-counter) "." counter(h4-counter) " ";
    }

    /* Heading 5 */
    .post > article h5 {
      counter-increment: h5-counter;
    }

    .post > article h5::before {
      content: counter(h1-counter) "." counter(h2-counter) "." counter(h3-counter) "." counter(h4-counter) "." counter(h5-counter) " ";
    }
  </style>



<div class="post">
  <article>
    <header class="post-header">
      <h1 class="post-title">PyTorch Neural Network Classification</h1>
      <p class="post-description"></p>
    </header>

    <p>A <a href="https://en.wikipedia.org/wiki/Statistical_classification" rel="external nofollow noopener" target="_blank">classification problem</a> involves predicting whether something is one thing or another.</p>

<p>For example, you might want to:</p>

<table class="styled-table">
    <thead>
    <tr>
    <th>Problem type</th>
    <th>What is it?</th>
    <th>Example</th>
    </tr>
    </thead>
    <tbody>
    <tr>
    <td><strong>Binary classification</strong></td>
    <td>Target can be one of two options, e.g. yes or no</td>
    <td>Predict whether or not someone has heart disease based on their health parameters.</td>
    </tr>
    <tr>
    <td><strong>Multi-class classification</strong></td>
    <td>Target can be one of more than two options</td>
    <td>Decide whether a photo is of food, a person or a dog.</td>
    </tr>
    <tr>
    <td><strong>Multi-label classification</strong></td>
    <td>Target can be assigned more than one option</td>
    <td>Predict what categories should be assigned to a Wikipedia article (e.g. mathematics, science &amp; philosophy).</td>
    </tr>
    </tbody>
</table>

<div class="row mt-3">
    
    <div class="col-sm mt-3 mt-md-0 text-center">
        <figure id="fig_different_classification_problems1">
  <picture>
    <img src="https://raw.githubusercontent.com/mrdbourke/pytorch-deep-learning/main/images/02-different-classification-problems.png" class="img-fluid rounded" style="
        
          
            max-width: 500px;
          
          height: auto;
          display: block;
          margin-left: auto;
          margin-right: auto;
        
      " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>
  
    <figcaption class="caption">
      Figure 1: Various different classification problems in machine learning such as binary, multiclass, and multilabel classification.
    </figcaption>
  
</figure>

    </div>
</div>

<p>Classification, along with regression (predicting a number, covered in <a href="/personal/assets/courses/basicai/02_pytorch_workflow">pytorch workflow</a> is one of the most common types of machine learning problems.</p>

<p>In this session, we’re going to work through a couple of different classification problems with PyTorch.</p>

<p>In other words, taking a set of inputs and predicting what class those set of inputs belong to.</p>

<h2 id="what-were-going-to-cover">What we’re going to cover</h2>

<p>In this notebook we’re going to reiterate over the PyTorch workflow we covered in <a href="/personal/assets/courses/basicai/02_pytorch_workflow">pytorch workflow</a>.</p>

<div class="row mt-3">
    
    <div class="col-sm mt-3 mt-md-0">
        <figure id="fig_pytorch_workflow2">
  <picture>
    <img src="https://raw.githubusercontent.com/mrdbourke/pytorch-deep-learning/main/images/01_a_pytorch_workflow.png" class="img-fluid rounded" style="
        
          
            max-width: 500px;
          
          height: auto;
          display: block;
          margin-left: auto;
          margin-right: auto;
        
      " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">
  </picture>
  
    <figcaption class="caption">
      Figure 2: A PyTorch workflow flowchart.
    </figcaption>
  
</figure>

    </div>
</div>

<p>Except instead of trying to predict a straight line (predicting a number, also called a regression problem), we’ll be working on a <strong>classification problem</strong>.</p>

<p>Specifically, we’re going to cover:</p>

<table class="styled-table">
<thead>
<tr>
<th><strong>Topic</strong></th>
<th><strong>Contents</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>0. Architecture of a classification neural network</strong></td>
<td>Neural networks can come in almost any shape or size, but they typically follow a similar floor plan.</td>
</tr>
<tr>
<td><strong>1. Getting binary classification data ready</strong></td>
<td>Data can be almost anything but to get started we're going to create a simple binary classification dataset.</td>
</tr>
<tr>
<td><strong>2. Building a PyTorch classification model</strong></td>
<td>Here we'll create a model to learn patterns in the data, we'll also choose a <strong>loss function</strong>, <strong>optimizer</strong> and build a <strong>training loop</strong> specific to classification.</td>
</tr>
<tr>
<td><strong>3. Fitting the model to data (training)</strong></td>
<td>We've got data and a model, now let's let the model (try to) find patterns in the (<strong>training</strong>) data.</td>
</tr>
<tr>
<td><strong>4. Making predictions and evaluating a model (inference)</strong></td>
<td>Our model's found patterns in the data, let's compare its findings to the actual (<strong>testing</strong>) data.</td>
</tr>
<tr>
<td><strong>5. Improving a model (from a model perspective)</strong></td>
<td>We've trained and evaluated a model but it's not working, let's try a few things to improve it.</td>
</tr>
<tr>
<td><strong>6. Non-linearity</strong></td>
<td>So far our model has only had the ability to model straight lines, what about non-linear (non-straight) lines?</td>
</tr>
<tr>
<td><strong>7. Replicating non-linear functions</strong></td>
<td>We used <strong>non-linear functions</strong> to help model non-linear data, but what do these look like?</td>
</tr>
<tr>
<td><strong>8. Putting it all together with multi-class classification</strong></td>
<td>Let's put everything we've done so far for binary classification together with a multi-class classification problem.</td>
</tr>
</tbody>
</table>

<h2 id="architecture-of-a-classification-neural-network">Architecture of a classification neural network</h2>

<p>Before we get into writing code, let’s look at the general architecture of a classification neural network.</p>

<table class="styled-table">
    <thead>
    <tr>
    <th><strong>Hyperparameter</strong></th>
    <th><strong>Binary Classification</strong></th>
    <th><strong>Multiclass classification</strong></th>
    </tr>
    </thead>
    <tbody>
    <tr>
    <td>
<strong>Input layer shape</strong> (<code>in_features</code>)</td>
    <td>Same as number of features (e.g. 5 for age, sex, height, weight, smoking status in heart disease prediction)</td>
    <td>Same as binary classification</td>
    </tr>
    <tr>
    <td><strong>Hidden layer(s)</strong></td>
    <td>Problem specific, minimum = 1, maximum = unlimited</td>
    <td>Same as binary classification</td>
    </tr>
    <tr>
    <td><strong>Neurons per hidden layer</strong></td>
    <td>Problem specific, generally 10 to 512</td>
    <td>Same as binary classification</td>
    </tr>
    <tr>
    <td>
<strong>Output layer shape</strong> (<code>out_features</code>)</td>
    <td>1 (one class or the other)</td>
    <td>1 per class (e.g. 3 for food, person or dog photo)</td>
    </tr>
    <tr>
    <td><strong>Hidden layer activation</strong></td>
    <td>Usually <a href="https://pytorch.org/docs/stable/generated/torch.nn.ReLU.html#torch.nn.ReLU" rel="external nofollow noopener" target="_blank">ReLU</a> (rectified linear unit) but <a href="https://en.wikipedia.org/wiki/Activation_function#Table_of_activation_functions" rel="external nofollow noopener" target="_blank">can be many others</a>
</td>
    <td>Same as binary classification</td>
    </tr>
    <tr>
    <td><strong>Output activation</strong></td>
    <td>
<a href="https://en.wikipedia.org/wiki/Sigmoid_function" rel="external nofollow noopener" target="_blank">Sigmoid</a> (<a href="https://pytorch.org/docs/stable/generated/torch.sigmoid.html" rel="external nofollow noopener" target="_blank"><code>torch.sigmoid</code></a> in PyTorch)</td>
    <td>
<a href="https://en.wikipedia.org/wiki/Softmax_function" rel="external nofollow noopener" target="_blank">Softmax</a> (<a href="https://pytorch.org/docs/stable/generated/torch.nn.Softmax.html" rel="external nofollow noopener" target="_blank"><code>torch.softmax</code></a> in PyTorch)</td>
    </tr>
    <tr>
    <td><strong>Loss function</strong></td>
    <td>
<a href="https://en.wikipedia.org/wiki/Cross_entropy#Cross-entropy_loss_function_and_logistic_regression" rel="external nofollow noopener" target="_blank">Binary crossentropy</a> (<a href="https://pytorch.org/docs/stable/generated/torch.nn.BCELoss.html" rel="external nofollow noopener" target="_blank"><code>torch.nn.BCELoss</code></a> in PyTorch)</td>
    <td>Cross entropy (<a href="https://pytorch.org/docs/stable/generated/torch.nn.CrossEntropyLoss.html" rel="external nofollow noopener" target="_blank"><code>torch.nn.CrossEntropyLoss</code></a> in PyTorch)</td>
    </tr>
    <tr>
    <td><strong>Optimizer</strong></td>
    <td>
<a href="https://pytorch.org/docs/stable/generated/torch.optim.SGD.html" rel="external nofollow noopener" target="_blank">SGD</a> (stochastic gradient descent), <a href="https://pytorch.org/docs/stable/generated/torch.optim.Adam.html" rel="external nofollow noopener" target="_blank">Adam</a> (see <a href="https://pytorch.org/docs/stable/optim.html" rel="external nofollow noopener" target="_blank"><code>torch.optim</code></a> for more options)</td>
    <td>Same as binary classification</td>
    </tr>
    </tbody>
</table>

<p>Of course, this ingredient list of classification neural network components will vary depending on the problem you’re working on.</p>

<p>But it’s more than enough to get started.</p>

<p>We’re going to get hands-on with this setup throughout this notebook.</p>

<h2 id="make-classification-data-and-get-it-ready">Make classification data and get it ready</h2>

<p>Let’s begin by making some data.</p>

<p>We’ll use the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_circles.html" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">make_circles()</code></a> method from Scikit-Learn to generate two circles with different coloured dots.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_circles</span>


<span class="c1"># Make 1000 samples 
</span><span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># Create circles
</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nf">make_circles</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span>
<span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="sh">"</span><span class="s">bash-block</span><span class="sh">"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">noise</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="c1"># a little bit of noise to the dots
</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span> <span class="c1"># keep random state so we get the same values&lt;/code&gt;&lt;/pre&gt;
</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>Alright, now let’s view the first 5 <code class="language-plaintext highlighter-rouge">X</code> and <code class="language-plaintext highlighter-rouge">y</code> values.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">First 5 X features:</span><span class="se">\n</span><span class="si">{</span><span class="n">X</span><span class="p">[</span><span class="si">:</span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">First 5 y labels:</span><span class="se">\n</span><span class="si">{</span><span class="n">y</span><span class="p">[</span><span class="si">:</span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<div class="bash-block">
<pre><code>First 5 X features:
[[ 0.75424625  0.23148074]
[-0.75615888  0.15325888]
[-0.81539193  0.17328203]
[-0.39373073  0.69288277]
[ 0.44220765 -0.89672343]]

First 5 y labels:
[1 1 1 1 0]</code></pre>
</div>

<p>Looks like there’s two <code class="language-plaintext highlighter-rouge">X</code> values per one <code class="language-plaintext highlighter-rouge">y</code> value.</p>

<p>Let’s keep following the data explorer’s motto of <em>visualize, visualize, visualize</em> and put them into a pandas DataFrame.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Make DataFrame of circle data
</span><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">circles</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="sh">"</span><span class="s">X1</span><span class="sh">"</span><span class="p">:</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                        <span class="sh">"</span><span class="s">X2</span><span class="sh">"</span><span class="p">:</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
                        <span class="sh">"</span><span class="s">label</span><span class="sh">"</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>
<span class="n">circles</span><span class="p">.</span><span class="nf">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<div>
  <table class="dataframe">
    <thead>
      <tr style="text-align: right;">
        <th></th>
        <th>X1</th>
        <th>X2</th>
        <th>label</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>0</th>
        <td>0.754246</td>
        <td>0.231481</td>
        <td>1</td>
      </tr>
      <tr>
        <th>1</th>
        <td>-0.756159</td>
        <td>0.153259</td>
        <td>1</td>
      </tr>
      <tr>
        <th>2</th>
        <td>-0.815392</td>
        <td>0.173282</td>
        <td>1</td>
      </tr>
      <tr>
        <th>3</th>
        <td>-0.393731</td>
        <td>0.692883</td>
        <td>1</td>
      </tr>
      <tr>
        <th>4</th>
        <td>0.442208</td>
        <td>-0.896723</td>
        <td>0</td>
      </tr>
      <tr>
        <th>5</th>
        <td>-0.479646</td>
        <td>0.676435</td>
        <td>1</td>
      </tr>
      <tr>
        <th>6</th>
        <td>-0.013648</td>
        <td>0.803349</td>
        <td>1</td>
      </tr>
      <tr>
        <th>7</th>
        <td>0.771513</td>
        <td>0.147760</td>
        <td>1</td>
      </tr>
      <tr>
        <th>8</th>
        <td>-0.169322</td>
        <td>-0.793456</td>
        <td>1</td>
      </tr>
      <tr>
        <th>9</th>
        <td>-0.121486</td>
        <td>1.021509</td>
        <td>0</td>
      </tr>
    </tbody>
  </table>
</div>

<p>It looks like each pair of <code class="language-plaintext highlighter-rouge">X</code> features (<code class="language-plaintext highlighter-rouge">X1</code> and <code class="language-plaintext highlighter-rouge">X2</code>) has a label (<code class="language-plaintext highlighter-rouge">y</code>) value of either 0 or 1.</p>

<p>This tells us that our problem is <strong>binary classification</strong> since there’s only two options (0 or 1).</p>

<p>How many values of each class are there?</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Check different labels
</span><span class="n">circles</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="nf">value_counts</span><span class="p">()</span>
</code></pre></div></div>
<div class="bash-block">
<pre><code>1    500
0    500
Name: label, dtype: int64</code></pre>
</div>

<p>500 each, nice and balanced.</p>

<p>Let’s plot them.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Visualize with a plot
</span><span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> 
<span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="sh">"</span><span class="s">bash-block</span><span class="sh">"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">y</span><span class="o">=</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
<span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
<span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">RdYlBu</span><span class="p">);</span><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</code></pre></div></div>
<div style="text-align: left;">
  <img src="/personal/assets/img/02_pytorch_classification_files/02_pytorch_classification_14_0.png" alt="png" class="img-fluid" style="max-width: 80%; height: auto; display: block; margin-bottom: 1rem;">
</div>

<p>Alrighty, looks like we’ve got a problem to solve.</p>

<p>Let’s find out how we could build a PyTorch neural network to classify dots into red (0) or blue (1).</p>

<div class="note-box">
<strong>Note:</strong> This dataset is often what's considered a **toy problem** (a problem that's used to try and test things out on) in machine learning.  But it represents the major key of classification, you have some kind of data represented as numerical values and you'd like to build a model that's able to classify it, in our case, separate it into red or blue dots.
</div>

<h3 id="input-and-output-shapes">Input and output shapes</h3>

<p>One of the most common errors in deep learning is shape errors.</p>

<p>Mismatching the shapes of tensors and tensor operations will result in errors in your models.</p>

<p>We’re going to see plenty of these throughout the course.</p>

<p>And there’s no surefire way to make sure they won’t happen, they will.</p>

<p>What you can do instead is continually familiarize yourself with the shape of the data you’re working with.</p>

<p>I like referring to it as input and output shapes.</p>

<p>Ask yourself:</p>

<p>“What shapes are my inputs and what shapes are my outputs?”</p>

<p>Let’s find out.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Check the shapes of our features and labels
</span><span class="n">X</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>
<div class="bash-block">
<pre><code>((1000, 2), (1000,))</code></pre>
</div>

<p>Looks like we’ve got a match on the first dimension of each.</p>

<p>There’s 1000 <code class="language-plaintext highlighter-rouge">X</code> and 1000 <code class="language-plaintext highlighter-rouge">y</code>.</p>

<p>But what’s the second dimension on <code class="language-plaintext highlighter-rouge">X</code>?</p>

<p>It often helps to view the values and shapes of a single sample (features and labels).</p>

<p>Doing so will help you understand what input and output shapes you’d be expecting from your model.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># View the first example of features and labels
</span><span class="n">X_sample</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y_sample</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Values for one sample of X: </span><span class="si">{</span><span class="n">X_sample</span><span class="si">}</span><span class="s"> and the same for y: </span><span class="si">{</span><span class="n">y_sample</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Shapes for one sample of X: </span><span class="si">{</span><span class="n">X_sample</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="s"> and the same for y: </span><span class="si">{</span><span class="n">y_sample</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<div class="bash-block">
<pre><code>Values for one sample of X: [0.75424625 0.23148074] and the same for y: 1
Shapes for one sample of X: (2,) and the same for y: ()</code></pre>
</div>

<p>This tells us the second dimension for <code class="language-plaintext highlighter-rouge">X</code> means it has two features (vector) where as <code class="language-plaintext highlighter-rouge">y</code> has a single feature (scalar).</p>

<p>We have two inputs for one output.</p>

<h3 id="turn-data-into-tensors-and-create-train-and-test-splits">Turn data into tensors and create train and test splits</h3>

<p>We’ve investigated the input and output shapes of our data, now let’s prepare it for being used with PyTorch and for modelling.</p>

<p>Specifically, we’ll need to:</p>
<ol>
  <li>Turn our data into tensors (right now our data is in NumPy arrays and PyTorch prefers to work with PyTorch tensors).</li>
  <li>Split our data into training and test sets (we’ll train a model on the training set to learn the patterns between <code class="language-plaintext highlighter-rouge">X</code> and <code class="language-plaintext highlighter-rouge">y</code> and then evaluate those learned patterns on the test dataset).</li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Turn data into tensors
# Otherwise this causes issues with computations later on
</span><span class="kn">import</span> <span class="n">torch</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">from_numpy</span><span class="p">(</span><span class="n">X</span><span class="p">).</span><span class="nf">type</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="nb">float</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">from_numpy</span><span class="p">(</span><span class="n">y</span><span class="p">).</span><span class="nf">type</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># View the first five samples
</span><span class="n">X</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="n">y</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div></div>

<div class="bash-block">
<pre><code>(tensor([[ 0.7542,  0.2315],
[-0.7562,  0.1533],
[-0.8154,  0.1733],
[-0.3937,  0.6929],
[ 0.4422, -0.8967]]),
tensor([1., 1., 1., 1., 0.]))</code></pre>
</div>

<p>Now our data is in tensor format, let’s split it into training and test sets.</p>

<p>To do so, let’s use the helpful function <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">train_test_split()</code></a> from Scikit-Learn.</p>

<p>We’ll use <code class="language-plaintext highlighter-rouge">test_size=0.2</code> (80% training, 20% testing) and because the split happens randomly across the data, let’s use <code class="language-plaintext highlighter-rouge">random_state=42</code> so the split is reproducible.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Split data into train and test sets
</span><span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> 
<span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="sh">"</span><span class="s">bash-block</span><span class="sh">"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">y</span><span class="p">,</span>
<span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="c1"># 20% test, 80% train
</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span> <span class="c1"># make the random split reproducible&lt;/code&gt;&lt;/pre&gt;
</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>

<span class="nf">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span> <span class="nf">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="nf">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span> <span class="nf">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
</code></pre></div></div>

<div class="bash-block">
<pre><code>(800, 200, 800, 200)</code></pre>
</div>

<p>Nice! Looks like we’ve now got 800 training samples and 200 testing samples.</p>


    

    
  </article>
</div>
</div>
          </div>
        
      
    </div>

    <!-- Footer -->
    
  <footer class="fixed-bottom" role="contentinfo">
    <div class="container mt-0">
      © Copyright 2024
      Jue
      
      Guo. 
      
      
        Last updated: December 26, 2024.
      
    </div>
  </footer>



    <!-- JavaScripts -->
    <!-- jQuery -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
<script src="/personal/assets/js/bootstrap.bundle.min.js"></script>
<!-- <script src="/personal/assets/js/mdb.min.js"></script> -->
<script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    
  <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script>
  <script defer src="/personal/assets/js/masonry.js" type="text/javascript"></script>


    

    

    

    

    

    

    

    

    

  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script>
  <script defer src="/personal/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script>


  <!-- Sidebar Table of Contents -->
  <script defer src="/personal/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script>


<!-- Bootstrap Table -->


<!-- Load Common JS -->
<script src="/personal/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script>
<script defer src="/personal/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script>
<script defer src="/personal/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script>

<!-- Jupyter Open External Links New Tab -->
<script defer src="/personal/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script>



    
  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>


  <script async src="https://badge.dimensions.ai/badge.js"></script>


    
  
    <!-- MathJax -->
    <script type="text/javascript">
      window.MathJax = {
        tex: {
          tags: 'ams',
        },
      };
    </script>
    <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script>
    <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script>
  

    

    



    
  <!-- Scrolling Progress Bar -->
  <script type="text/javascript">
    /*
     * This JavaScript code has been adapted from the article
     * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar,
     * published on the website https://css-tricks.com on the 7th of May, 2014.
     * Couple of changes were made to the original code to make it compatible
     * with the `al-foio` theme.
     */
    const progressBar = $('#progress');
    /*
     * We set up the bar after all elements are done loading.
     * In some cases, if the images in the page are larger than the intended
     * size they'll have on the page, they'll be resized via CSS to accomodate
     * the desired size. This mistake, however, breaks the computations as the
     * scroll size is computed as soon as the elements finish loading.
     * To account for this, a minimal delay was introduced before computing the
     * values.
     */
    window.onload = function () {
      setTimeout(progressBarSetup, 50);
    };
    /*
     * We set up the bar according to the browser.
     * If the browser supports the progress element we use that.
     * Otherwise, we resize the bar thru CSS styling
     */
    function progressBarSetup() {
      if ('max' in document.createElement('progress')) {
        initializeProgressElement();
        $(document).on('scroll', function () {
          progressBar.attr({ value: getCurrentScrollPosition() });
        });
        $(window).on('resize', initializeProgressElement);
      } else {
        resizeProgressBar();
        $(document).on('scroll', resizeProgressBar);
        $(window).on('resize', resizeProgressBar);
      }
    }
    /*
     * The vertical scroll position is the same as the number of pixels that
     * are hidden from view above the scrollable area. Thus, a value > 0 is
     * how much the user has scrolled from the top
     */
    function getCurrentScrollPosition() {
      return $(window).scrollTop();
    }

    function initializeProgressElement() {
      let navbarHeight = $('#navbar').outerHeight(true);
      $('body').css({ 'padding-top': navbarHeight });
      $('progress-container').css({ 'padding-top': navbarHeight });
      progressBar.css({ top: navbarHeight });
      progressBar.attr({
        max: getDistanceToScroll(),
        value: getCurrentScrollPosition(),
      });
    }
    /*
     * The offset between the html document height and the browser viewport
     * height will be greater than zero if vertical scroll is possible.
     * This is the distance the user can scroll
     */
    function getDistanceToScroll() {
      return $(document).height() - $(window).height();
    }

    function resizeProgressBar() {
      progressBar.css({ width: getWidthPercentage() + '%' });
    }
    // The scroll ratio equals the percentage to resize the bar
    function getWidthPercentage() {
      return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
    }
  </script>


    

    

    

    
  <script src="/personal/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script>
  <script>
    addBackToTop();
  </script>


    

  </body>
</html>
